{% load i18n %}
{% load officialsites %}


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <title>{% block title %} {{ SITENAME }} {% endblock %}</title>
    <link rel="shortcut icon" href="{{ STATIC_URL }}theme/img/favicon.ico"/>
    <script src="{{ STATIC_URL }}geonode/externals/lib/js/jquery.js"></script>
    <script type="text/javascript" src="{{ GEONODE_CLIENT_LOCATION }}externals/ext/adapter/jquery/ext-jquery-adapter.js"></script>
    {% include 'autocomplete_light/static.html' %}
    {% block head_extra_meta %}{% endblock %}
    {% block head %}

        <script src="{{ STATIC_URL }}bootstrap/js/bootstrap.min.js"></script>


        {% if urlsuffix %}
            <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}{{urlsuffix}}/boilerplate-min.css" media="screen" />
            <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}{{urlsuffix}}/site.css" media="screen" />
            <!--[if lte IE 6]><link rel="stylesheet" href="{{STATIC_URL}}theme/boilerplate-ie-min.css" type="text/css" media="screen" charset="utf-8"><![endif]-->
        {% else %}
            <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}theme/boilerplate-min.css" media="screen" />
            <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}theme/site.css"  media="screen" />
            <!--[if lte IE 6]><link rel="stylesheet" href="{{ STATIC_URL }}theme/boilerplate-ie-min.css" type="text/css" media="screen" charset="utf-8"><![endif]-->
        {% endif %}

        <script type="text/javascript" src="{% url "jscat" %}"></script>
        <script type="text/javascript" src="{% url "django.views.i18n.javascript_catalog" %}"></script>
        <script type="text/javascript" src="{% url "lang" %}"></script>


    {% endblock %}
    {% autoescape off %}
        {{ GOOGLE_ANALYTICS_CODE }}
    {% endautoescape %}

    <script type="text/javascript">
        function hideModal() {
            Ext.get("modalhelp").setStyle("display","none");
        }
        function showModal(text) {
            Ext.get("modalhelp").setStyle("display","block").update(text);
        }
        function showHelp(event) {
            showModal(event.target.innerHTML);
        }
        if (Ext.onReady) {
            Ext.onReady(function() {
                {% autoescape off %}
                    Ext.select(".helptext").on('mouseover',showHelp);
                    Ext.select(".helptext").on('mouseout',hideModal);
                {% endautoescape %}
            });
        }

        $(document).ajaxStart(function ()
        {
            $('html').addClass('wait');
        }).ajaxComplete(function () {
                    $('html').removeClass('wait');
                });
    </script>
</head>
<body class="{% block body_class %}{% endblock %}">
{% block start_body_js %}{% endblock %}
<div id="wrap">

    <div id="header">
        <div class="wrap selfclear">
            {% block logos %}
                {% block breadcrumb %}
                    {% if urlsuffix %}
                        {% if map.officialurl %}
                            <div id="page-breadcrumb"><a href="{% url "geonode.maps.views.official_site" map.officialurl %}">{{title}}</a></div>
                        {% else %}
                            <div id="page-breadcrumb"><span>{{title}}</span></div>
                        {% endif %}

                    {% else %}
                        <a id="logo" href="{% url "home" %}"><img src="{{STATIC_URL}}theme/img/WorldMap-Logo_26px.png" border="0"></a>
                        <div id="page-breadcrumb"><span>{{title}}</span></div>
                    {% endif %}
                {% endblock %}
            {% endblock logos %}
            <div id="login-area">
                {% if user.is_authenticated %}
                    <a href="{{ user.get_profile.get_absolute_url }}">{{ user.username}}</a> | <a href="{% url "account_logout" %}">{% trans "Log out" %}</a>
                {% else %}
                    <!-- this should be updated to a url var -->
                    <a href="/account/login?next={% if 'logout' not in request.path %}{{request.path}}{% else %}/{% endif %}"
                            >{% trans "Sign in" %}</a>
                {% endif %}
                | <a class="" id="mapLink" href="/maps/new">{% trans "Create Map" %}</a>
                | <a class="" id="viewLink" href="{% url "maps_search" %}?sort=last_modified&dir=DESC">{% trans "View Map" %}</a>
                | <a class="" id="helpLink" href="{{ STATIC_URL }}docs/WorldMap_Help_{{LANGUAGE_CODE}}.pdf" target="_blank">{% trans "Help" %}</a>
            </div>
        </div><!-- /.wrap -->
    </div><!-- /#header -->

    <div id="main">
        {% block content %}{% endblock %}
        <div class="wrap selfclear">
            {% block body %}{% endblock %}
            {% block sidebar %}{% endblock %}
        </div><!-- /.wrap -->
    </div><!-- /#main -->
    <div id="push"></div>
</div>

<div id="footer">
    <div class="wrap selfclear">
        {% block footer %}

            <!-- Only show the language form if the csrf_token is present -->
            {% if csrf_token != "NOTPROVIDED" and False %}
                {% get_current_language as LANGUAGE %}
                <form class="langbar" id="target" action="/i18n/setlang/" method="post">
                    {% csrf_token %}
                    <div style="display: inline;float:left;">
                        <select id="langval" name="language" onchange="javascript:form.submit()">
                            {% for lang in LANGUAGES %}
                                <option value="{{ lang.0 }}"
                                        {% ifequal LANGUAGE_CODE lang.0 %} selected="selected"{% endifequal %}>
                                    {{ lang.1 }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                </form>
            {% endif %}

            <div class="onecolft" style="text-align:center">
                <a href="{{site}}{{ STATIC_URL }}docs/WorldMap_Help_{{LANGUAGE_CODE}}.pdf">{% trans "Need Help?" %}</a>&nbsp;&nbsp;
                <a href="mailto:worldmap@harvard.edu">{%  trans "Contact Us" %}</a>&nbsp;&nbsp;
                <a href="http://projects.iq.harvard.edu/worldmap/blog">{% trans "Blog" %}</a>&nbsp;&nbsp;
                <a href="https://github.com/cga-harvard/cga-worldmap">{% trans "Source Code" %}</a>&nbsp;&nbsp;
                {% trans "Copyright 2011 &copy; The President and Fellows of Harvard College" %}
            </div>
        {% endblock %}
    </div><!-- /.wrap -->
</div><!-- /#footer -->


{% block extra_body %}{% endblock %}{% block end_body_js %}{% endblock %}
<div id="modalhelp" class="modal_help"></div>
{% block extra_script %}{% endblock extra_script %}
</body>
</html>
